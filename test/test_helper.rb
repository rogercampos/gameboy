require 'minitest/rg'
require 'minitest/autorun'

require 'sdl2'

Dir["lib/gameboy/*.rb"].each { |x| require_relative "../#{x}" }

class BaseTest < Minitest::Test
  def set_arg_1(value)
    Gameboy::MMU.bwrite(Gameboy::Registers.pc, value)
  end

  def set_arg_1_w(value)
    Gameboy::MMU.wwrite(Gameboy::Registers.pc, value)
  end
end

class DummyRom
  START = 0x0150

  SCAFFOLDING = [
    195, 12, 2, 0, 0, 0, 0, 0, 195, 12, 2, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 135, 225, 95, 22, 0, 25,
    94, 35, 86, 213, 225, 233, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 195, 126, 1, 255,
    255, 255, 255, 255, 195, 190, 38, 255, 255, 255, 255, 255, 195, 190, 38, 255, 255, 255, 255, 255, 195, 91,
    0, 245, 229, 213, 197, 205, 107, 0, 62, 1, 224, 204, 193, 209, 225, 241, 217, 240, 205, 239, 120, 0, 159,
    0, 164, 0, 186, 0, 234, 39, 240, 225, 254, 7, 40, 8, 254, 6, 200, 62, 6, 224, 225, 201, 240, 1, 254, 85,
    32, 8, 62, 41, 224, 203, 62, 1, 24, 8, 254, 41, 192, 62, 85, 224, 203, 175, 224, 2, 201, 240, 1, 224, 208,
    201, 240, 1, 224, 208, 240, 203, 254, 41, 200, 240, 207, 224, 1, 62, 255, 224, 207, 62, 128, 224, 2, 201,
    240, 1, 224, 208, 240, 203, 254, 41, 200, 240, 207, 224, 1, 251, 205, 152, 10, 62, 128, 224, 2, 201, 240,
    205, 254, 2, 192, 175, 224, 15, 251, 201, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 0, 195, 80, 1, 206, 237, 102, 102, 204, 13, 0, 11, 3, 115, 0, 131, 0, 12, 0, 13, 0, 8,
    17, 31, 136, 137, 0, 14, 220, 204, 110, 230, 221, 221, 217, 153, 187, 187, 103, 99, 110, 14, 236, 204, 221,
    220, 153, 159, 187, 185, 51, 62, 84, 69, 84, 82, 73, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 1, 1, 10, 22, 191].freeze

  def initialize(bytes)
    @bytes = bytes
  end

  def body
    (SCAFFOLDING + @bytes).pack("C*")
  end
end